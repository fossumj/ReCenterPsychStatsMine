JustANOVA$TradPed <- sjstats::mean_n(JustANOVA[, ..TradPed_vars], .75)
big <- readRDS("ReC.rds")
JustANOVA <- subset(big, Course == "ANOVA")
TwoWay_df <-(dplyr::select (JustANOVA, Year, Dept, TradPed))
JustANOVA <-(dplyr::select (JustANOVA, Year, Dept, TradPed))
big <- readRDS("ReC.rds")
big$Stage <- plyr::mapvalues(big$Year, from = c(2017, 2018, 2019, 2020, 2021), to = c("Stable", "Transition", "Transition", "Resettled", "Resettled"))
str(big$Stage)
big$Stage <- factor(big$Stage, levels = c("Stable", "Transition", "Resettled"))
str(big$Stage)
#Creates a list of the variables that belong to that scale
TradPed_vars <- c('ClearResponsibilities', 'EffectiveAnswers','Feedback', 'ClearOrganization','ClearPresentation')
#Calculates a mean if at least 75% of the items are non-missing; adjusts the calculating when there is missingness
big$TradPed <- sjstats::mean_n(big[, TradPed_vars], .75)
#Creates a list of the variables that belong to that scale
TradPed_vars <- c('ClearResponsibilities', 'EffectiveAnswers','Feedback', 'ClearOrganization','ClearPresentation')
#Calculates a mean if at least 75% of the items are non-missing; adjusts the calculating when there is missingness
big$TradPed <- sjstats::mean_n(big[,TradPed_vars], .75)
#Creates a list of the variables that belong to that scale
TradPed_vars <- c('ClearResponsibilities', 'EffectiveAnswers','Feedback', 'ClearOrganization','ClearPresentation')
#Calculates a mean if at least 75% of the items are non-missing; adjusts the calculating when there is missingness
big$TradPed <- sjstats::mean_n(big[, ..TradPed_vars], .75)
TwoWay_df <-(dplyr::select (big, Stage, Dept, TradPed))
df <- na.omit(TwoWay_df)
TwoWay_df <- subset(big, Course == "ANOVA")
TwoWay_df <-(dplyr::select (big, Stage, Dept, TradPed))
df <- na.omit(TwoWay_df)
psych::describeBy(TradPed ~ Stage + Dept, mat = TRUE, data = TwoWay_df, digits = 3, type = 1)
View(TwoWay_df)
View(big)
TwoWay_df[TwoWay_df$Stage == "Stable" & TwoWay_df$TradPed < 4.3, "Dept"]<- "ORG"
psych::describeBy(TradPed ~ Stage + Dept, mat = TRUE, data = TwoWay_df, digits = 3, type = 1)
TwoWay_TradPed <- aov(TradPed ~ Stage * Dept, TwoWay_df)
summary(TwoWay_TradPed)
resid_TradPed <- residuals(TwoWay_TradPed)
shapiro.test(resid_TradPed)
hist(resid_TradPed)
qqnorm(resid_TradPed)
TwoWay_df %>%
rstatix::identify_outliers(TradPed)
library(tidyverse)
TwoWay_df %>%
rstatix::identify_outliers(TradPed)
rstatix::levene_test(TwoWay_df, TradPed ~ Dept * Stage)
big <- readRDS("ReC.rds")
big$Stage <- plyr::mapvalues(big$Year, from = c(2017, 2018, 2019, 2020, 2021), to = c("Stable", "Transition", "Transition", "Resettled", "Resettled"))
str(big$Stage)
big$Stage <- factor(big$Stage, levels = c("Stable", "Transition", "Resettled"))
str(big$Stage)
#Creates a list of the variables that belong to that scale
TradPed_vars <- c('ClearResponsibilities', 'EffectiveAnswers','Feedback', 'ClearOrganization','ClearPresentation')
#Calculates a mean if at least 75% of the items are non-missing; adjusts the calculating when there is missingness
big$TradPed <- sjstats::mean_n(big[, ..TradPed_vars], .75)
TwoWay_df <- subset(big, Course == "ANOVA")
TwoWay_df <-(dplyr::select (big, Stage, Dept, TradPed))
df <- na.omit(TwoWay_df)
TwoWay_df[TwoWay_df$Stage == "Stable" & TwoWay_df$TradPed < 4.3, "Dept"]<- "ORG"
psych::describeBy(TradPed ~ Stage + Dept, mat = TRUE, data = TwoWay_df, digits = 3, type = 1)
TwoWay_TradPed <- aov(TradPed ~ Stage * Dept, TwoWay_df)
summary(TwoWay_TradPed)
resid_TradPed <- residuals(TwoWay_TradPed)
shapiro.test(resid_TradPed)
hist(resid_TradPed)
qqnorm(resid_TradPed)
library(tidyverse)
TwoWay_df %>%
rstatix::identify_outliers(TradPed)
big <- readRDS("ReC.rds")
big$Stage <- plyr::mapvalues(big$Year, from = c(2017, 2018, 2019, 2020, 2021), to = c("Stable", "Transition", "Transition", "Resettled", "Resettled"))
str(big$Stage)
big$Stage <- factor(big$Stage, levels = c("Stable", "Transition", "Resettled"))
str(big$Stage)
#Creates a list of the variables that belong to that scale
TradPed_vars <- c('ClearResponsibilities', 'EffectiveAnswers','Feedback', 'ClearOrganization','ClearPresentation')
#Calculates a mean if at least 75% of the items are non-missing; adjusts the calculating when there is missingness
big$TradPed <- sjstats::mean_n(big[, ..TradPed_vars], .75)
#Creates a list of the variables that belong to that scale
TradPed_vars <- c('ClearResponsibilities', 'EffectiveAnswers','Feedback', 'ClearOrganization','ClearPresentation')
#Calculates a mean if at least 75% of the items are non-missing; adjusts the calculating when there is missingness
big$TradPed <- sjstats::mean_n(big[, ..TradPed_vars], .75)
TwoWay_df <- subset(big, Course == "ANOVA")
TwoWay_df <- subset(big, Course == "ANOVA")
TwoWay_df <-(dplyr::select (TwoWay_df, Stage, Dept, TradPed))
df <- na.omit(TwoWay_df)
TwoWay_df[TwoWay_df$Stage == "Stable" & TwoWay_df$TradPed < 4.3, "Dept"]<- "ORG"
psych::describeBy(TradPed ~ Stage + Dept, mat = TRUE, data = TwoWay_df, digits = 3, type = 1)
TwoWay_TradPed <- aov(TradPed ~ Stage * Dept, TwoWay_df)
summary(TwoWay_TradPed)
resid_TradPed <- residuals(TwoWay_TradPed)
shapiro.test(resid_TradPed)
hist(resid_TradPed)
qqnorm(resid_TradPed)
library(tidyverse)
TwoWay_df %>%
rstatix::identify_outliers(TradPed)
rstatix::levene_test(TwoWay_df, TradPed ~ Dept * Stage)
omnibus2w <- rstatix::anova_test(TwoWay_df, TradPed ~ Dept * Stage, type = "2", detailed = TRUE)
omnibus2w
omnibus2w <- rstatix::anova_test(TwoWay_df, TradPed ~ Dept * Stage, type = "2", detailed = TRUE)
omnibus2w
contrasts(TwoWay_df$Stage)
c1 <- c(-2, 1, 1)
c2 <- c(0, -1, 1)
mat <- cbind(c1, c2)  #combine the above bits
contrasts(TwoWay_df$Stage) <- mat  # attach the contrasts to the variable
c1 <- c(-2, 1, 1)
c2 <- c(0, -1, 1)
mat <- cbind(c1, c2)  #combine the above bits
contrasts(TwoWay_df$Stage) <- mat  # attach the contrasts to the variable
c1 <- c(-2, 1, 1)
c2 <- c(0, -1, 1)
mat <- cbind(c1, c2)  #combine the above bits
contrasts(TwoWay_df$Stage) <- mat  # attach the contrasts to the variable
contrasts(TwoWay_df$Stage)
CPY_df <- subset(TwoWay_df, Dept == "CPY")
# change df to subset, new model name
big <- readRDS("ReC.rds")
big$Stage <- plyr::mapvalues(big$Year, from = c(2017, 2018, 2019, 2020, 2021), to = c("Stable", "Transition", "Transition", "Resettled", "Resettled"))
str(big$Stage)
big$Stage <- factor(big$Stage, levels = c("Stable", "Transition", "Resettled"))
str(big$Stage)
#Creates a list of the variables that belong to that scale
TradPed_vars <- c('ClearResponsibilities', 'EffectiveAnswers','Feedback', 'ClearOrganization','ClearPresentation')
#Calculates a mean if at least 75% of the items are non-missing; adjusts the calculating when there is missingness
big$TradPed <- sjstats::mean_n(big[, TradPed_vars], .75)
#Creates a list of the variables that belong to that scale
TradPed_vars <- c('ClearResponsibilities', 'EffectiveAnswers','Feedback', 'ClearOrganization','ClearPresentation')
#Calculates a mean if at least 75% of the items are non-missing; adjusts the calculating when there is missingness
big$TradPed <- sjstats::mean_n(big[, TradPed_vars], .75, drop = FALSE)
#Creates a list of the variables that belong to that scale
TradPed_vars <- c('ClearResponsibilities', 'EffectiveAnswers','Feedback', 'ClearOrganization','ClearPresentation')
#Calculates a mean if at least 75% of the items are non-missing; adjusts the calculating when there is missingness
big$TradPed <- sjstats::mean_n(big[, TradPed_vars], ..75)
#Creates a list of the variables that belong to that scale
TradPed_vars <- c('ClearResponsibilities', 'EffectiveAnswers','Feedback', 'ClearOrganization','ClearPresentation')
#Calculates a mean if at least 75% of the items are non-missing; adjusts the calculating when there is missingness
big$TradPed <- sjstats::mean_n(big[, ..TradPed_vars], .75)
TwoWay_df <- subset(big, Course == "ANOVA")
TwoWay_df <-(dplyr::select (TwoWay_df, Stage, Dept, TradPed))
df <- na.omit(TwoWay_df)
TwoWay_df <- subset(big, Course == "ANOVA")
TwoWay_df <-(dplyr::select (TwoWay_df, Stage, Dept, TradPed))
df <- na.omit(TwoWay_df)
TwoWay_df[TwoWay_df$Stage == "Stable" & TwoWay_df$TradPed < 4.3, "Dept"]<- "ORG"
TwoWay_df[TwoWay_df$Stage == "Stable" & TwoWay_df$TradPed < 4.3, "Dept"]<- "ORG"
psych::describeBy(TradPed ~ Stage + Dept, mat = TRUE, data = TwoWay_df, digits = 3, type = 1)
TwoWay_TradPed <- aov(TradPed ~ Stage * Dept, TwoWay_df)
summary(TwoWay_TradPed)
resid_TradPed <- residuals(TwoWay_TradPed)
shapiro.test(resid_TradPed)
resid_TradPed <- residuals(TwoWay_TradPed)
shapiro.test(resid_TradPed)
hist(resid_TradPed)
library(tidyverse)
TwoWay_df %>%
rstatix::identify_outliers(TradPed)
rstatix::levene_test(TwoWay_df, TradPed ~ Dept * Stage)
omnibus2w <- rstatix::anova_test(TwoWay_df, TradPed ~ Dept * Stage, type = "2", detailed = TRUE)
omnibus2w
TwoWay_df %>%
dplyr::group_by(Stage)%>%
rstatix::anova_test(TradPed ~ Dept)
TwoWay_df %>%
dplyr::group_by(Dept)%>%
rstatix::anova_test(TradPed ~ Stage)
TwoWay_df %>%
dplyr::group_by(Dept)%>%
rstatix::anova_test(TradPed ~ Stage)
ggpubr::ggboxplot(TwoWay_df, x = "Dept", y = "TradPed", color = "Stage", xlab = "Academic Department",
ylab = "Students' Evaluations of Traditional Pedagogy", add = "jitter",
title = "Course Evaluations as a Function of Department and Stage in Transition")
pwTRwiDP <- TwoWay_df %>%
dplyr::group_by(Dept) %>%
rstatix::emmeans_test(TradPed ~ Stage, p.adjust.method = "holm")
pwTRwiDP
Box2way<- ggpubr::ggboxplot(TwoWay_df, x = "Dept", y = "TradPed", color = "Stage", xlab = "Academic Department",
ylab = "Students' Evaluations of Traditional Pedagogy", add = "jitter",
title = "Course Evaluations as a Function of Department and Stage in Transition")
Box2way<- ggpubr::ggboxplot(TwoWay_df, x = "Dept", y = "TradPed", color = "Stage", xlab = "Academic Department",
ylab = "Students' Evaluations of Traditional Pedagogy", add = "jitter",
title = "Course Evaluations as a Function of Department and Stage in Transition")
Box2way
Box2way<- ggpubr::ggboxplot(TwoWay_df, x = "Dept", y = "TradPed", color = "Stage", xlab = "Academic Department",
ylab = "Students' Evaluations of Traditional Pedagogy", add = "jitter",
title = "Course Evaluations as a Function of Department and Stage in Transition", ylim = c (1,5))
Box2way
pwTRwiDP <- pwTRwiDP %>%
rstatix::add_xy_position(x = "Dept")  #x should be whatever the variable was used in the group_by argument
Box2way <- Box2way + ggpubr::stat_pvalue_manual(pwTRwiDP, label = "p.adj.signif", tip.length = 0.02, hide.ns = TRUE, y.position = c(5.5))
pwTRwiDP <- pwTRwiDP %>%
rstatix::add_xy_position(x = "Dept")  #x should be whatever the variable was used in the group_by argument
Box2way <- Box2way + ggpubr::stat_pvalue_manual(pwTRwiDP, label = "p.adj.signif", tip.length = 0.02, hide.ns = TRUE, y.position = c(5.5))
Box2way
pwTRwiDP <- pwTRwiDP %>%
rstatix::add_xy_position(x = "Dept")  #x should be whatever the variable was used in the group_by argument
Box2way <- Box2way + ggpubr::stat_pvalue_manual(pwTRwiDP, label = "p.adj.signif", tip.length = 0.02, hide.ns = TRUE, y.position = c(5.25, 5.5))
Box2way<- ggpubr::ggboxplot(TwoWay_df, x = "Dept", y = "TradPed", color = "Stage", xlab = "Academic Department",
ylab = "Students' Evaluations of Traditional Pedagogy", add = "jitter",
title = "Course Evaluations as a Function of Department and Stage in Transition")
Box2way
pwTRwiDP <- pwTRwiDP %>%
rstatix::add_xy_position(x = "Dept")  #x should be whatever the variable was used in the group_by argument
Box2way <- Box2way + ggpubr::stat_pvalue_manual(pwTRwiDP, label = "p.adj.signif", tip.length = 0.02, hide.ns = TRUE, y.position = c(5.5))
Box2way
pwTRwiDP <- pwTRwiDP %>%
rstatix::add_xy_position(x = "Dept")  #x should be whatever the variable was used in the group_by argument
Box2way <- Box2way + ggpubr::stat_pvalue_manual(pwTRwiDP, label = "p.adj.signif", tip.length = 0.02, hide.ns = TRUE, y.position = c(5.25))
Box2way
pwTRwiDP <- pwTRwiDP %>%
rstatix::add_xy_position(x = "Dept")  #x should be whatever the variable was used in the group_by argument
Box2way <- Box2way + ggpubr::stat_pvalue_manual(pwTRwiDP, label = "p.adj.signif", tip.length = 0.02, hide.ns = TRUE, y.position = c(5.25))
Box2way
pwTRwiDP <- pwTRwiDP %>%
rstatix::add_xy_position(x = "Dept")  #x should be whatever the variable was used in the group_by argument
Box2way <- Box2way + ggpubr::stat_pvalue_manual(pwTRwiDP, label = "p.adj.signif", tip.length = 0.02, hide.ns = TRUE, y.position = c(5.25))
Box2way
pwTRwiDP <- pwTRwiDP %>%
rstatix::add_xy_position(x = "Dept")  #x should be whatever the variable was used in the group_by argument
Box2way <- Box2way + ggpubr::stat_pvalue_manual(pwTRwiDP, label = "p.adj.signif", tip.length = 0.02, hide.ns = TRUE, y.position = c(5.5))
Box2way
pwTRwiDP <- pwTRwiDP %>%
rstatix::add_xy_position(x = "Dept")  #x should be whatever the variable was used in the group_by argument
Box2way <- Box2way + ggpubr::stat_pvalue_manual(pwTRwiDP, label = "p.adj.signif", tip.length = 0.02, hide.ns = TRUE, y.position = c(5.25))
Box2way
big <- readRDS("ReC.rds")
big$Stage <- plyr::mapvalues(big$Year, from = c(2017, 2018, 2019, 2020, 2021), to = c("Stable", "Transition", "Transition", "Resettled", "Resettled"))
str(big$Stage)
big$Stage <- factor(big$Stage, levels = c("Stable", "Transition", "Resettled"))
str(big$Stage)
#Creates a list of the variables that belong to that scale
TradPed_vars <- c('ClearResponsibilities', 'EffectiveAnswers','Feedback', 'ClearOrganization','ClearPresentation')
#Calculates a mean if at least 75% of the items are non-missing; adjusts the calculating when there is missingness
big$TradPed <- sjstats::mean_n(big[, ..TradPed_vars], .75)
TwoWay_df <- subset(big, Course == "ANOVA")
TwoWay_df <-(dplyr::select (TwoWay_df, Stage, Dept, TradPed))
df <- na.omit(TwoWay_df)
TwoWay_df[TwoWay_df$Stage == "Stable" & TwoWay_df$TradPed < 4.3, "Dept"]<- "ORG"
Box2way<- ggpubr::ggboxplot(TwoWay_df, x = "Dept", y = "TradPed", color = "Stage", xlab = "Academic Department",
ylab = "Students' Evaluations of Traditional Pedagogy", add = "jitter",
title = "Course Evaluations as a Function of Department and Stage in Transition")
Box2way
psych::describeBy(TradPed ~ Stage + Dept, mat = TRUE, data = TwoWay_df, digits = 3, type = 1)
TwoWay_TradPed <- aov(TradPed ~ Stage * Dept, TwoWay_df)
summary(TwoWay_TradPed)
resid_TradPed <- residuals(TwoWay_TradPed)
shapiro.test(resid_TradPed)
hist(resid_TradPed)
qqnorm(resid_TradPed)
library(tidyverse)
TwoWay_df %>%
rstatix::identify_outliers(TradPed)
rstatix::levene_test(TwoWay_df, TradPed ~ Dept * Stage)
omnibus2w <- rstatix::anova_test(TwoWay_df, TradPed ~ Dept * Stage, type = "2", detailed = TRUE)
omnibus2w
TwoWay_df %>%
dplyr::group_by(Dept)%>%
rstatix::anova_test(TradPed ~ Stage)
pwTRwiDP <- TwoWay_df %>%
dplyr::group_by(Dept) %>%
rstatix::emmeans_test(TradPed ~ Stage, p.adjust.method = "holm")
pwTRwiDP
pwTRwiDP <- pwTRwiDP %>%
rstatix::add_xy_position(x = "Dept")  #x should be whatever the variable was used in the group_by argument
Box2way <- Box2way + ggpubr::stat_pvalue_manual(pwTRwiDP, label = "p.adj.signif", tip.length = 0.02, hide.ns = TRUE, y.position = c(5.25))
Box2way
pwTRwiDP <- pwTRwiDP %>%
rstatix::add_xy_position(x = "Dept")  #x should be whatever the variable was used in the group_by argument
Box2way <- Box2way + ggpubr::stat_pvalue_manual(pwTRwiDP, label = "p.adj.signif", tip.length = 0.02, hide.ns = TRUE, y.position = c(5.3))
Box2way
big <- readRDS("ReC.rds")
big$Stage <- plyr::mapvalues(big$Year, from = c(2017, 2018, 2019, 2020, 2021), to = c("Stable", "Transition", "Transition", "Resettled", "Resettled"))
str(big$Stage)
big$Stage <- factor(big$Stage, levels = c("Stable", "Transition", "Resettled"))
str(big$Stage)
#Creates a list of the variables that belong to that scale
TradPed_vars <- c('ClearResponsibilities', 'EffectiveAnswers','Feedback', 'ClearOrganization','ClearPresentation')
#Calculates a mean if at least 75% of the items are non-missing; adjusts the calculating when there is missingness
big$TradPed <- sjstats::mean_n(big[, ..TradPed_vars], .75)
TwoWay_df <- subset(big, Course == "ANOVA")
TwoWay_df <-(dplyr::select (TwoWay_df, Stage, Dept, TradPed))
df <- na.omit(TwoWay_df)
TwoWay_df[TwoWay_df$Stage == "Stable" & TwoWay_df$TradPed < 4.3, "Dept"]<- "ORG"
Box2way<- ggpubr::ggboxplot(TwoWay_df, x = "Dept", y = "TradPed", color = "Stage", xlab = "Academic Department",
ylab = "Students' Evaluations of Traditional Pedagogy", add = "jitter",
title = "Course Evaluations as a Function of Department and Stage in Transition")
Box2way
psych::describeBy(TradPed ~ Stage + Dept, mat = TRUE, data = TwoWay_df, digits = 3, type = 1)
TwoWay_TradPed <- aov(TradPed ~ Stage * Dept, TwoWay_df)
summary(TwoWay_TradPed)
resid_TradPed <- residuals(TwoWay_TradPed)
shapiro.test(resid_TradPed)
hist(resid_TradPed)
qqnorm(resid_TradPed)
library(tidyverse)
TwoWay_df %>%
rstatix::identify_outliers(TradPed)
rstatix::levene_test(TwoWay_df, TradPed ~ Dept * Stage)
omnibus2w <- rstatix::anova_test(TwoWay_df, TradPed ~ Dept * Stage, type = "2", detailed = TRUE)
omnibus2w
TwoWay_df %>%
dplyr::group_by(Dept)%>%
rstatix::anova_test(TradPed ~ Stage)
pwTRwiDP <- TwoWay_df %>%
dplyr::group_by(Dept) %>%
rstatix::emmeans_test(TradPed ~ Stage, p.adjust.method = "holm")
pwTRwiDP
pwTRwiDP <- pwTRwiDP %>%
rstatix::add_xy_position(x = "Dept")  #x should be whatever the variable was used in the group_by argument
Box2way <- Box2way + ggpubr::stat_pvalue_manual(pwTRwiDP, label = "p.adj.signif", tip.length = 0.02, hide.ns = TRUE, y.position = c(5.3))
Box2way
apaTables::apa.2way.table(Dept, Stage, TradPed, data = TwoWay_df, filename = "2Way.doc", table.number = 1, show.marginal.means = TRUE)
apaTables::apa.2way.table(Dept, Stage, TradPed, data = TwoWay_df, filename = "2Way.doc", table.number = 1, show.marginal.means = TRUE, landscape = TRUE)
effectsize::eta2_to_f(0.042) #FactorA -- Dept
effectsize::eta2_to_f(0.064) #Factor B -- Stage
effectsize::eta2_to_f(0.013) #interaction
(12+24+36+9+20+11)/3
(12+24+36+9+20+11)/2
12+24+36+9+20+11
(12+24+36+9+20+11)/3
(12+24+36+9+20+11)/2
pwr2::pwr.2way(a = 2, b = 3, alpha = 0.05, size.A = 37, size.B = 56, f.A = 0.042, f.B = 0.063)
pwr2::ss.2way(a = 2, b = 3, alpha = 0.05, beta = 0.8, f.A = 0.042, f.B = 0.063, B = 100)
psych::describe(TwoWay_df)
TwoWay_df <- TwoWay_df %>%
dplyr::mutate(m_dev = TradPed = 4.06)
TwoWay_df <- TwoWay_df %>%
dplyr::mutate(m_dev = TradPed - 4.06)
head(TwoWay_df)
TwoWay_df <- TwoWay_df %>%
mutate(m_devSQ = m_dev^2)
head(TwoWay_df)
SST <- sum(TwoWay_df$m_devSQ)
SST
SST <- sum(TwoWay_df$m_devSQ, na.rm=TRUE)
SST
psych::describeBy(TradPed ~ Dept + Stage, mat = TRUE, data = TwoWay_df, digits = 3)
psych::describeBy(TradPed ~ Dept + Stage, mat = TRUE, data = TwoWay_df, digits = 3)
SSM <- 12 * (4.817 - 4.06)^2 + 9 * (3.889 - 2.947)^2 + 24 * (4.317 - 4.06)^2 +
20 * (3.720 - 4.06)^2 + 36 * (3.836 - 4.06)^2 + 11 * (4.145 - 4.06)^2
SSM
((0.217^2)*(12-1))+ ((0.348^2)*(9-1)) + ((0.700^2)*(24-1)) + ((1.264^2)*(20-1)) + ((0.805^2)*(36-1)) + ((0.658^2)*(11-1))
psych::describeBy(TradPed ~ Dept, mat=TRUE, data = TwoWay_df, digits=3)
SSM_dept <- 72 * (4.160 - 4.06)^2 + 37 * (3.875 - 4.06)^2
SSM_dept <- 72 * (4.160 - 4.06)^2 + 37 * (3.875 - 4.06)^2
SSM_dept
psych::describeBy(TradPed ~ Stage, mat=TRUE, data = TwoWay_df, digits=3)
SSM_stage <- 21 * (4.160 - 4.06)^2 + 44 * (4.045 - 4.06)^2 + 47 * (3.909 - 4.06)^2
SSM_stage
SSM_int <- 20.64585 - (1.986325 + 1.291547)
SSM_int
20.646 _ 1.986 + 1.292 + 17.368 + 70.124
20.646 + 1.986 + 1.292 + 17.368 + 70.124
1.986 + 1.292 + 17.368 + 70.124
SSM <- 12 * (4.817 - 4.06)^2 + 9 * (3.889 - 2.947)^2 + 24 * (4.317 - 4.06)^2 +
20 * (3.720 - 4.06)^2 + 36 * (3.836 - 4.06)^2 + 11 * (4.145 - 4.06)^2
SSM
SSR <- ((0.217^2)*(12-1))+ ((0.348^2)*(9-1)) + ((0.700^2)*(24-1)) + ((1.264^2)*(20-1)) + ((0.805^2)*(36-1)) + ((0.658^2)*(11-1))
SSR
20.646 + 70.124
(1.986 + 1.292 + 17.368) + 70.124
20.646/5
1.986/1
1.292/2
17.368/6
70.124/109
4.1282/70.124
1.986/70.124
0.646/70.124
2.985/70.124
0.6433/70.124
20.646/5
1.986/1
1.292/2
17.368/2
70.124/109
4.1282/70.124
1.986/70.124
0.646/70.124
8.684/70.124
0.6433/70.124
4.1282/70.124
1.986/70.124
0.646/70.124
8.684/70.124
0.6433/70.124
qf(0.05, 5, 109, lower.tail = FALSE)  #omnibus
qf(0.05, 1, 109, lower.tail = FALSE)  #Dept main effect
qf(0.05, 2, 109, lower.tail = FALSE)  #Stage main effect
qf(0.05, 5, 109, lower.tail = FALSE)  #interaction term
qf(0.05, 5, 109, lower.tail = FALSE)  #omnibus
qf(0.05, 1, 109, lower.tail = FALSE)  #Dept main effect
qf(0.05, 2, 109, lower.tail = FALSE)  #Stage main effect
qf(0.05, 2, 109, lower.tail = FALSE)  #interaction term
4.1282/0.643
1.986/0.643
0.646/0.643
8.684/0.643
0.6433/0.643
20.646/5
1.986/1
1.292/2
17.368/2
70.124/106
4.1282/0.662
1.986/0.662
0.646/0.662
8.684/0.662
20.646 + 70.124
(1.986 + 1.292 + 17.368) + 70.124
1.986 + 1.292 + 17.368
big <- readRDS("ReC.rds")
big$Stage <- plyr::mapvalues(big$Year, from = c(2017, 2018, 2019, 2020, 2021), to = c("Stable", "Transition", "Transition", "Resettled", "Resettled"))
str(big$Stage)
big$Stage <- factor(big$Stage, levels = c("Stable", "Transition", "Resettled"))
str(big$Stage)
#Creates a list of the variables that belong to that scale
TradPed_vars <- c('ClearResponsibilities', 'EffectiveAnswers','Feedback', 'ClearOrganization','ClearPresentation')
#Calculates a mean if at least 75% of the items are non-missing; adjusts the calculating when there is missingness
big$TradPed <- sjstats::mean_n(big[, TradPed_vars], .75)
#if the scoring script won't run, try this one:
#big$TradPed <- sjstats::mean_n(big[, ..TradPed_vars], .75)
TwoWay_df <- subset(big, Course == "ANOVA")
TwoWay_df <-(dplyr::select (TwoWay_df, Stage, Dept, TradPed))
df <- na.omit(TwoWay_df)
TwoWay_df <- na.omit(TwoWay_df) #the next operation required non-missing data
TwoWay_df[TwoWay_df$Stage == "Stable" & TwoWay_df$TradPed < 4.3, "Dept"]<- "ORG"
Box2way<- ggpubr::ggboxplot(TwoWay_df, x = "Dept", y = "TradPed", color = "Stage", xlab = "Academic Department",
ylab = "Students' Evaluations of Traditional Pedagogy", add = "jitter",
title = "Course Evaluations as a Function of Department and Stage in Transition")
Box2way
psych::describeBy(TradPed ~ Stage + Dept, mat = TRUE, data = TwoWay_df, digits = 3, type = 1)
TwoWay_TradPed <- aov(TradPed ~ Stage * Dept, TwoWay_df)
summary(TwoWay_TradPed)
resid_TradPed <- residuals(TwoWay_TradPed)
shapiro.test(resid_TradPed)
hist(resid_TradPed)
qqnorm(resid_TradPed)
library(tidyverse)
TwoWay_df %>%
rstatix::identify_outliers(TradPed)
rstatix::levene_test(TwoWay_df, TradPed ~ Dept * Stage)
omnibus2w <- rstatix::anova_test(TwoWay_df, TradPed ~ Dept * Stage, type = "2", detailed = TRUE)
omnibus2w
TwoWay_df %>%
dplyr::group_by(Dept)%>%
rstatix::anova_test(TradPed ~ Stage)
pwTRwiDP <- TwoWay_df %>%
dplyr::group_by(Dept) %>%
rstatix::emmeans_test(TradPed ~ Stage, p.adjust.method = "holm")
pwTRwiDP
apaTables::apa.2way.table(Dept, Stage, TradPed, data = TwoWay_df, filename = "2Way.doc", table.number = 1, show.marginal.means = TRUE, landscape = TRUE)
pwTRwiDP <- pwTRwiDP %>%
rstatix::add_xy_position(x = "Dept")  #x should be whatever the variable was used in the group_by argument
Box2way <- Box2way + ggpubr::stat_pvalue_manual(pwTRwiDP, label = "p.adj.signif", tip.length = 0.02, hide.ns = TRUE, y.position = c(5.3))
Box2way
effectsize::eta2_to_f(0.042) #FactorA -- Dept
effectsize::eta2_to_f(0.064) #Factor B -- Stage
effectsize::eta2_to_f(0.013) #interaction
12+24+36+9+20+11
(12+24+36+9+20+11)/3
(12+24+36+9+20+11)/2
pwr2::pwr.2way(a = 2, b = 3, alpha = 0.05, size.A = 37, size.B = 56, f.A = 0.042, f.B = 0.063)
pwr2::ss.2way(a = 2, b = 3, alpha = 0.05, beta = 0.8, f.A = 0.042, f.B = 0.063, B = 100)
psych::describe(TwoWay_df)
TwoWay_df <- TwoWay_df %>%
dplyr::mutate(m_dev = TradPed - 4.06)
head(TwoWay_df)
TwoWay_df <- TwoWay_df %>%
mutate(m_devSQ = m_dev^2)
head(TwoWay_df)
SST <- sum(TwoWay_df$m_devSQ, na.rm=TRUE)
SST
SSM <- 12 * (4.817 - 4.06)^2 + 9 * (3.889 - 4.06)^2 + 24 * (4.317 - 4.06)^2 +
20 * (3.720 - 4.06)^2 + 36 * (3.836 - 4.06)^2 + 11 * (4.145 - 4.06)^2
SSM
SSM_dept <- 72 * (4.160 - 4.06)^2 + 40 * (3.875 - 4.06)^2
SSM_dept
SSM_stage <- 21 * (4.419 - 4.06)^2 + 44 * (4.045 - 4.06)^2 + 47 * (3.909 - 4.06)^2
SSM_stage
SSM_int <- 12.923 - (2.089 + 3.788)
SSM_int
SSR <- ((0.217^2)*(12-1))+ ((0.348^2)*(9-1)) + ((0.700^2)*(24-1)) + ((1.264^2)*(20-1)) + ((0.805^2)*(36-1)) + ((0.658^2)*(11-1))
SSR
12.923 + 70.124
(2.089 + 3.788 + 7.046) + 70.124
2.089 + 3.788 + 7.046
12.923/5
2.089/1
3.788/2
7.046/2
70.124/106
2.585/0.662
2.089/0.662
1.894/0.662
3.523/0.662
qf(0.05, 5, 106, lower.tail = FALSE)  #omnibus
qf(0.05, 1, 106, lower.tail = FALSE)  #Dept main effect
qf(0.05, 2, 106, lower.tail = FALSE)  #Stage main effect
qf(0.05, 2, 106, lower.tail = FALSE)  #interaction term
SSM_int <- 12.923 - (2.089 + 3.788)
SSM_int
12.923/5
2.5846/.662
2.089/.662
3.788/2
1.894/.662
7.047/2
3.523/.662
2.089/83.033 #eta squared for department main effect
3.788/80.033 #eta squared for stage main effect
7.046/80.033 #eta squared for interaction effect
You may notice that the results from the hand calculation are slightly different from the results I will obtain with the R packages. This is because the formula we have used for the hand-calculations utilizes an  approach to calculating the sums of squares that presumes that we have a balanced design (i.e., that the cell sizes are equal). When cell sizes are unequal (i.e., an unbalanced design) the Type II package in *rstatix::anova_test* will produce different result.
